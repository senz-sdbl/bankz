package com.wasn.utils;

import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothDevice;
import android.bluetooth.BluetoothSocket;
import com.wasn.exceptions.BluetoothNotAvailableException;
import com.wasn.exceptions.BluetoothNotEnableException;
import com.wasn.exceptions.CannotConnectToPrinterException;
import com.wasn.exceptions.CannotPrintException;
import com.wasn.pojos.Setting;
import com.wasn.pojos.Summary;
import com.wasn.pojos.Transaction;

import java.io.IOException;
import java.io.OutputStream;
import java.util.UUID;

/**
 * Class deal with generic printing functionality
 *
 * @author eranga.herath@pagero.com (eranga herath)
 */
public class PrintUtils {

    // printing service UUID
    private static final UUID SERVICE_UUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB");

    // printer bluetooth address
    //private static String bluetoothAddress = "00:22:58:38:AE:90";

    /**
     * Get bluetooth adapter to deal with bluetooth related functionalities
     * @return bluetooth adapter
     */
    private static BluetoothAdapter getBluetoothAdapter() {
        return BluetoothAdapter.getDefaultAdapter();
    }

    /**
     * check weather bluetooth enabled
     * @return state
     * @throws BluetoothNotEnableException
     * @throws BluetoothNotAvailableException
     */
    public static boolean isEnableBluetooth() throws BluetoothNotEnableException, BluetoothNotAvailableException {
        if(getBluetoothAdapter() == null) {
            throw new BluetoothNotAvailableException();
        } else {
            if(!getBluetoothAdapter().isEnabled()) {
                throw new BluetoothNotEnableException();
            }
        }

        return true;
    }

    /**
     * Connect to printer
     * @param bluetoothAddress printer address
     * @return outputStream
     * @throws BluetoothNotEnableException
     * @throws BluetoothNotAvailableException
     * @throws IOException
     * @throws CannotConnectToPrinterException
     */
    private static OutputStream connectToPrinter(String bluetoothAddress) throws BluetoothNotEnableException, BluetoothNotAvailableException, IOException, CannotConnectToPrinterException, IllegalArgumentException {
        OutputStream outputStream = null;

        if(isEnableBluetooth()) {
            // bluetooth configurations
            BluetoothAdapter bluetoothAdapter = getBluetoothAdapter();
            BluetoothDevice bluetoothDevice = bluetoothAdapter.getRemoteDevice(bluetoothAddress);
            BluetoothSocket bluetoothSocket = bluetoothDevice.createRfcommSocketToServiceRecord(SERVICE_UUID);

            bluetoothAdapter.cancelDiscovery();
            bluetoothSocket.connect();

            outputStream = bluetoothSocket.getOutputStream();
        }

        if(outputStream == null) {
            throw new CannotConnectToPrinterException();
        } else {
            return outputStream;
        }
    }

    /**
     * Print receipt via bluetooth
     * @param transaction printing transaction
     * @param settings
     * @throws IOException
     * @throws BluetoothNotEnableException
     * @throws BluetoothNotAvailableException
     * @throws CannotConnectToPrinterException
     * @throws CannotPrintException
     */
    public static void printReceipt(Transaction transaction, Setting settings) throws IOException, BluetoothNotEnableException, BluetoothNotAvailableException, CannotConnectToPrinterException, CannotPrintException, IllegalArgumentException {
        OutputStream outputStream = connectToPrinter(settings.getPrinterAddress());

        // receipt header
        String address      = ".           SANASA Development Bank\r\n";
        String branch       = "            Branch       : " + settings.getBranch() + "\r\n";
        String telephoneNo  = "            Telephone No : " + settings.getTelephone()  + "\r\n";

        // printing receipt type
        // customer copy/ agent copy
        String receiptType  = "                 (Customer copy)    \r\n\r\n";

        // logo printing command
        // ZPL(Zebra Program Language)
        String printLogoCommand = "! 0 200 200 150 1\r\n"  // 150 is the hight of the image
                + "EG 28 126 200 10 " // EG 8LineWidth(16hex for 8 word) 126Lines 200x-cordinate 10y-cordinate
                + "000000000000000000000000003E00000000000000000000000000000000000000000000000000003FFF0000000000000000000000000000000000000000000000000007FFFF000000000000000000000000000000000000000000000000003" +
                "FFFFE00000000000000000000000000000000000000000000000001FFFC0000000000000000000000000000000000000000000000000007FF00000000000000000000000000000000000000000000000000001FF801FFFF0000000000000000000000" +
                "0000000000000000000000007FC03FFFFFFC00000000000000000000000000000000000000000001FE01FFFFFFFF80000000000000000000000000000000000000000003FC0FFFE003FFF8000000000000000000000000000000000000000007F07FF" +
                "800001FFE00000000000000000000000000000000000000001FC0FFC0000001FFC0000000000000000000000000000000000000003F83FE03FFFFC03FF0000000000000000000000000000000000000007E0FF83FFFFFFC07FC000000000000000000" +
                "00000000000000000000FC1FE0FFFFFFFF81FE00000000000000000000000000000000000001F83F83FFE00FFFF07F80000000000000000000000000000000000003F0FE0FFC00003FFC1FC0000000000000000000000000000000000003E1FC3FE00" +
                "1E007FF07E0000000000000000000000000000000000007C3F87F007FFF80FFC3F800000000000000000000000000000000000FC3F0FE03FFFFF81FE0FC00000000000000000000000000000000000F87E3F80FFFFFFF07F87E000000000000000000" +
                "00000000000000001F0FC7F03FFFFFFFC3FC3F00000000000000000000000000000000001F1F8FE0FFFFC03FF0FE1F00000000000000000000000000000000003E1F0F81FFFF0007FC7F0F80000000000000000000000000000000003E3F1F83FFFF0" +
                "001FE3F87C0000000000000000000000000000000003E3E3F07FFFF00007F1FC7E0000000000000000000000000000000007C7C3E0FFFFF00003F8FE3E0000000000000000000000000000000007C7C7C0FFFFF00001FC7E1F0000000000000000000" +
                "000000000000007C7C7C0FFFFF800007E7F1F0000000000000000000000000000000007CF8F80FFFFFC00003F3F0F80000000000000000000000000000000078F8F80FFFFFF00001F1F8F800000000000000000000000000000000F8F8F80FFFFFFC0" +
                "001F9F87C00000000000000000000000000000000F8F8F80FFFFFFF0000F8FC7C00000000000000000000000000000000F8F8F80FFFFFFFC000FCFC7C00000000000000000000000000000000F8F8F007FFFFFFE0007CFC7C00000000000000000000" +
                "000000000000F8F8F803FFFFFFF8007C7C3E00000000000000000000000000000000F8F8F801FFFFFFFC007C7E3E00000000000000000000000000000000F8F8F800FFFFFFFE007C7E3E0000000000000000000000000000000078F8F8007FFFFFFF0" +
                "07C7E3E0000000000000000000000000000000078FCF8001FFFFFFF007E7E3E00000000000000000000000000000000787CFC000FFFFFFF807C7E3E000000000000000000000000000000007C7C7C0003FFFFFF807C7E3E0000000000000000000000" +
                "00000000007C7E7E0000FFFFFF807C7E3E000000000000000000000000000000003C3E3F00007FFFFF807C7E7E000000000000000000000000000000003E3F3F80001FFFFF807C7C7E000000000000000000000000000000003E1F1FC0000FFFFF80F" +
                "8FC7C000000000000000000000000000000001F0F8FE00007FFFF80F8FC7C000000000000000000000000000000001F0FC7F00003FFFF81F0FC7C000000000000000000000000000000000F87E3FC0003FFFF03F1F8FC000000000000000000000000" +
                "0000000007C3F1FF0003FFFF03E1F8F80000000000000000000000000000000007C1F87FC007FFFE07C3F1F80000000000000000000000000000000003E0FE3FF00FFFFC0FC7E1F80000000000000000000000000000000001F07F0FFFFFFFF81F8FE" +
                "3F00000000000000000000000000000000000F83F83FFFFFFE03F0FC3F000000000000000000000000000000000007C0FE0FFFFFF80FE1F87E000000000000000000000000000000000003F07F81FFFFE03F87F0FC000000000000000000000000000" +
                "000000001F81FE01FFE00FF0FE1FC0000000000000000000000000000000000007E0FFC000003FE1FC3F80000000000000000000000000000000000003F83FF80001FF87F87F00000000000000000000000000000000000000FC0FFFFF7FFE1FF0FE0" +
                "00000000000000000000000000000000000007F81FFFFFFF87FC1FC000000000000000000000000000000000000001FE03FFFFFC1FF83F80000000000000000000000000000000000000007FC00FFF80FFE0FE0000000000000000000000000000000" +
                "0000000001FFC000007FF83FC000000000000000000000000000000000000000003FFF803FFFE07F80000000000000000000000000000000000000000007FFFFFFFF01FE00000000000000000000000000000000000000000000FFFFFFF807F800000" +
                "0000000000000000000000000000000000000000FFFFF803FE000000000000000000000000000000000000000000000003FE001FF80000000000000000000000000000000000000000000000000000FFE000000000000000000000000000000000000" +
                "0000000000000003FFF000000000000000000000000000000000000000000000000001FFFF8000000000000000000000000000000000000000000000000001FFFC0000000000000000000000000000000000000000000000000001FFC000000000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007FC01FFFC007FFF80000000000000000000000000000000000000001FFF83FFFF807FFFF0000000000000000000" +
                "000000000000000000007FFFC3FFFFE07FFFFC00000000000000000000000000000000000000FFFFF3FFFFF07FFFFE00000000000000000000000000000000000001FFFFF07FFFF81FFFFF00000000000000000000000000000000000001FC03F07E0" +
                "3FC0F80FF03F0000000000001F800000000000000000001F801F07E01FC0F803F03F0000000000001F800000000000000000003F801F07E00FE0F803F80F00000000000007800000000000000000003F801F07E007E0F803F80700000000000007800" +
                "000000000000000001F800F07E007E0F803F00700000000000007800000000000000000001FC00007E007F0F803F00700000000000007800000000000000000001FF00007E003F0F807F00700000000000007800000000000000000000FFE0007E003" +
                "F0FFFFE0073F003F01F1F0078FE0000000000000000007FFC007E003F0FFFFC0077F80FFC3F7F8078FF0000000000000000003FFF007E003F0FFFFC007FFC1FFE1FFFC078FF0000000000000000000FFF807E003F0FFFFE007C3E1C1F07C3E0787800" +
                "000000000000000001FFE07E003F0FFFFF00781E1C0F0781E078F0000000000000000000003FE07E003F0F803F80700E18070700E079F0000000000000000000000FF07E003F0F801F80700E00070780E079E0000000000000000001E003F07E007F0" +
                "F801F80700F000F0780E07FC0000000000000000003E003F07E007E0F801FC0700F07FF0780E07F80000000000000000003F003F07E00FE0F801FC0700F1FFF0780E07FC0000000000000000003F003F07E00FE0F801F80700F1E070780E079E00000" +
                "00000000000003F003F07E01FC0F801F80700F3C070780E078F0000000000000000003FC0FF07E0FF80F80FF80700E3C070780E078F0000000000000000001FFFFE1FFFFF87FFFFF00781E3C0F0780E07878000000000000000000FFFFC3FFFFF07FF" +
                "FFE007C3E3C3F0700E0783C0000000000000000007FFF83FFFFC07FFFFC007FFC1FFF9FE7F9FE7F0000000000000000001FFF03FFFF007FFFF00077F80FF7BFE7FDFE7F80000000000000000003F8000000000000000023E007C79FC3F9FC3F000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000080006000310040000000000000000000000000000000000000400000800C40007300C0000000000000000000" +
                "000000000000000000C00001800CC0007201C8000000000000000000000000000000000000C00003003D8000E623C880C000000000000000000000000000000001800C0B3039E380E4F913C7C0000000000000000000000000000000030F1F3E2033E" +
                "6C1ED9B33EEC0000000000000000000000000000000030D366660236C813B32267D80000000000000000000000000000000021B66CCE066CF837B36645980000000000000000000000000000000061E64CDB044CF0272664CD9200000000000000000" +
                "000000000000000434CC993C4C984636ECCD91600000000000000000000000000000000DD1D99BB848BD8423FFF311C00000000000000000000000000000000FDE7FEEF078C6000000000000000000000000000\r\n"
                + "PRINT\r\n";


        // transaction details that print in receipt
        String accNo  = "      Account No         : "+transaction.getClientAccountNo()+"\r\n";
        String name   = "      Name               : "+transaction.getClientName()+"\r\n";
        String mobNo  = "      Mobile No          : "+transaction.getClientMobile()+"\r\n";
        String time   = "      Transaction time   : "+transaction.getTransactionTime()+"\r\n";
        String amount = "      Transaction amount : "+transaction.getTransactionAmount()+ ".00" + "\r\n\r\n\r\n";

        String sign   = "..................          ..................\r\n";
        String end    = "    Customer                       Agent      \r\n\r\n\r\n";

        // send dat to printer
        // send data as byte stream
        try {
            // print customer copy
            outputStream.write(printLogoCommand.getBytes());
            outputStream.write(address.getBytes());
            outputStream.write(branch.getBytes());
            outputStream.write(telephoneNo.getBytes());
            outputStream.write(receiptType.getBytes());
            outputStream.write(accNo.getBytes());
            outputStream.write(name.getBytes());
            outputStream.write(mobNo.getBytes());
            outputStream.write(time.getBytes());
            outputStream.write(amount.getBytes());
            outputStream.write(sign.getBytes());
            outputStream.write(end.getBytes());

            //empty for loop for accurate use
            for(int i=0;i<10000;i++) {

            }
            Thread.sleep(10000);

            receiptType = "                  (Agent copy)      \r\n\r\n";

            // print agent copy
            outputStream.write(printLogoCommand.getBytes());
            outputStream.write(address.getBytes());
            outputStream.write(branch.getBytes());
            outputStream.write(telephoneNo.getBytes());
            outputStream.write(receiptType.getBytes());
            outputStream.write(accNo.getBytes());
            outputStream.write(name.getBytes());
            outputStream.write(mobNo.getBytes());
            outputStream.write(time.getBytes());
            outputStream.write(amount.getBytes());
            outputStream.write(sign.getBytes());
            outputStream.write(end.getBytes());

            //empty for loop for accurate use
            for(int i=0;i<10000;i++){

            }
            Thread.sleep(2000);

            outputStream.flush();
        } catch(Exception e) {
            throw new CannotPrintException();
        } finally {
            // close streams
            try {
                outputStream.close();
            } catch(Exception e) {
                throw new CannotPrintException();
            }
        }
    }

    /**
     * Re-print receipt
     * @param transaction transaction to re-print
     * @param settings
     * @throws IOException
     * @throws BluetoothNotEnableException
     * @throws BluetoothNotAvailableException
     * @throws CannotConnectToPrinterException
     * @throws CannotPrintException
     */
    public static void rePrintReceipt(Transaction transaction, Setting settings) throws IOException, BluetoothNotEnableException, BluetoothNotAvailableException, CannotConnectToPrinterException, CannotPrintException, IllegalArgumentException {
        OutputStream outputStream = connectToPrinter(settings.getPrinterAddress());

        // receipt header
        String address      = ".           SANASA Development Bank\r\n";
        String branch       = "            Branch       : " + settings.getBranch() + "\r\n";
        String telephoneNo  = "            Telephone No : " + settings.getTelephone()  + "\r\n";

        // printing receipt type
        // customer copy/ agent copy
        String receiptType  = "           (Reprint Agent/Customer copy)      \r\n\r\n";

        // logo printing command
        // ZPL(Zebra Program Language)
        String printLogoCommand = "! 0 200 200 150 1\r\n"  //"! 0 200 200 150 1\r\n"
                + "EG 28 126 200 10 " // EG 8LineWidth(16hex for 8 word) 128NoLine 100x 60y
                + "000000000000000000000000003E00000000000000000000000000000000000000000000000000003FFF0000000000000000000000000000000000000000000000000007FFFF000000000000000000000000000000000000000000000000003" +
                "FFFFE00000000000000000000000000000000000000000000000001FFFC0000000000000000000000000000000000000000000000000007FF00000000000000000000000000000000000000000000000000001FF801FFFF0000000000000000000000" +
                "0000000000000000000000007FC03FFFFFFC00000000000000000000000000000000000000000001FE01FFFFFFFF80000000000000000000000000000000000000000003FC0FFFE003FFF8000000000000000000000000000000000000000007F07FF" +
                "800001FFE00000000000000000000000000000000000000001FC0FFC0000001FFC0000000000000000000000000000000000000003F83FE03FFFFC03FF0000000000000000000000000000000000000007E0FF83FFFFFFC07FC000000000000000000" +
                "00000000000000000000FC1FE0FFFFFFFF81FE00000000000000000000000000000000000001F83F83FFE00FFFF07F80000000000000000000000000000000000003F0FE0FFC00003FFC1FC0000000000000000000000000000000000003E1FC3FE00" +
                "1E007FF07E0000000000000000000000000000000000007C3F87F007FFF80FFC3F800000000000000000000000000000000000FC3F0FE03FFFFF81FE0FC00000000000000000000000000000000000F87E3F80FFFFFFF07F87E000000000000000000" +
                "00000000000000001F0FC7F03FFFFFFFC3FC3F00000000000000000000000000000000001F1F8FE0FFFFC03FF0FE1F00000000000000000000000000000000003E1F0F81FFFF0007FC7F0F80000000000000000000000000000000003E3F1F83FFFF0" +
                "001FE3F87C0000000000000000000000000000000003E3E3F07FFFF00007F1FC7E0000000000000000000000000000000007C7C3E0FFFFF00003F8FE3E0000000000000000000000000000000007C7C7C0FFFFF00001FC7E1F0000000000000000000" +
                "000000000000007C7C7C0FFFFF800007E7F1F0000000000000000000000000000000007CF8F80FFFFFC00003F3F0F80000000000000000000000000000000078F8F80FFFFFF00001F1F8F800000000000000000000000000000000F8F8F80FFFFFFC0" +
                "001F9F87C00000000000000000000000000000000F8F8F80FFFFFFF0000F8FC7C00000000000000000000000000000000F8F8F80FFFFFFFC000FCFC7C00000000000000000000000000000000F8F8F007FFFFFFE0007CFC7C00000000000000000000" +
                "000000000000F8F8F803FFFFFFF8007C7C3E00000000000000000000000000000000F8F8F801FFFFFFFC007C7E3E00000000000000000000000000000000F8F8F800FFFFFFFE007C7E3E0000000000000000000000000000000078F8F8007FFFFFFF0" +
                "07C7E3E0000000000000000000000000000000078FCF8001FFFFFFF007E7E3E00000000000000000000000000000000787CFC000FFFFFFF807C7E3E000000000000000000000000000000007C7C7C0003FFFFFF807C7E3E0000000000000000000000" +
                "00000000007C7E7E0000FFFFFF807C7E3E000000000000000000000000000000003C3E3F00007FFFFF807C7E7E000000000000000000000000000000003E3F3F80001FFFFF807C7C7E000000000000000000000000000000003E1F1FC0000FFFFF80F" +
                "8FC7C000000000000000000000000000000001F0F8FE00007FFFF80F8FC7C000000000000000000000000000000001F0FC7F00003FFFF81F0FC7C000000000000000000000000000000000F87E3FC0003FFFF03F1F8FC000000000000000000000000" +
                "0000000007C3F1FF0003FFFF03E1F8F80000000000000000000000000000000007C1F87FC007FFFE07C3F1F80000000000000000000000000000000003E0FE3FF00FFFFC0FC7E1F80000000000000000000000000000000001F07F0FFFFFFFF81F8FE" +
                "3F00000000000000000000000000000000000F83F83FFFFFFE03F0FC3F000000000000000000000000000000000007C0FE0FFFFFF80FE1F87E000000000000000000000000000000000003F07F81FFFFE03F87F0FC000000000000000000000000000" +
                "000000001F81FE01FFE00FF0FE1FC0000000000000000000000000000000000007E0FFC000003FE1FC3F80000000000000000000000000000000000003F83FF80001FF87F87F00000000000000000000000000000000000000FC0FFFFF7FFE1FF0FE0" +
                "00000000000000000000000000000000000007F81FFFFFFF87FC1FC000000000000000000000000000000000000001FE03FFFFFC1FF83F80000000000000000000000000000000000000007FC00FFF80FFE0FE0000000000000000000000000000000" +
                "0000000001FFC000007FF83FC000000000000000000000000000000000000000003FFF803FFFE07F80000000000000000000000000000000000000000007FFFFFFFF01FE00000000000000000000000000000000000000000000FFFFFFF807F800000" +
                "0000000000000000000000000000000000000000FFFFF803FE000000000000000000000000000000000000000000000003FE001FF80000000000000000000000000000000000000000000000000000FFE000000000000000000000000000000000000" +
                "0000000000000003FFF000000000000000000000000000000000000000000000000001FFFF8000000000000000000000000000000000000000000000000001FFFC0000000000000000000000000000000000000000000000000001FFC000000000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007FC01FFFC007FFF80000000000000000000000000000000000000001FFF83FFFF807FFFF0000000000000000000" +
                "000000000000000000007FFFC3FFFFE07FFFFC00000000000000000000000000000000000000FFFFF3FFFFF07FFFFE00000000000000000000000000000000000001FFFFF07FFFF81FFFFF00000000000000000000000000000000000001FC03F07E0" +
                "3FC0F80FF03F0000000000001F800000000000000000001F801F07E01FC0F803F03F0000000000001F800000000000000000003F801F07E00FE0F803F80F00000000000007800000000000000000003F801F07E007E0F803F80700000000000007800" +
                "000000000000000001F800F07E007E0F803F00700000000000007800000000000000000001FC00007E007F0F803F00700000000000007800000000000000000001FF00007E003F0F807F00700000000000007800000000000000000000FFE0007E003" +
                "F0FFFFE0073F003F01F1F0078FE0000000000000000007FFC007E003F0FFFFC0077F80FFC3F7F8078FF0000000000000000003FFF007E003F0FFFFC007FFC1FFE1FFFC078FF0000000000000000000FFF807E003F0FFFFE007C3E1C1F07C3E0787800" +
                "000000000000000001FFE07E003F0FFFFF00781E1C0F0781E078F0000000000000000000003FE07E003F0F803F80700E18070700E079F0000000000000000000000FF07E003F0F801F80700E00070780E079E0000000000000000001E003F07E007F0" +
                "F801F80700F000F0780E07FC0000000000000000003E003F07E007E0F801FC0700F07FF0780E07F80000000000000000003F003F07E00FE0F801FC0700F1FFF0780E07FC0000000000000000003F003F07E00FE0F801F80700F1E070780E079E00000" +
                "00000000000003F003F07E01FC0F801F80700F3C070780E078F0000000000000000003FC0FF07E0FF80F80FF80700E3C070780E078F0000000000000000001FFFFE1FFFFF87FFFFF00781E3C0F0780E07878000000000000000000FFFFC3FFFFF07FF" +
                "FFE007C3E3C3F0700E0783C0000000000000000007FFF83FFFFC07FFFFC007FFC1FFF9FE7F9FE7F0000000000000000001FFF03FFFF007FFFF00077F80FF7BFE7FDFE7F80000000000000000003F8000000000000000023E007C79FC3F9FC3F000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000080006000310040000000000000000000000000000000000000400000800C40007300C0000000000000000000" +
                "000000000000000000C00001800CC0007201C8000000000000000000000000000000000000C00003003D8000E623C880C000000000000000000000000000000001800C0B3039E380E4F913C7C0000000000000000000000000000000030F1F3E2033E" +
                "6C1ED9B33EEC0000000000000000000000000000000030D366660236C813B32267D80000000000000000000000000000000021B66CCE066CF837B36645980000000000000000000000000000000061E64CDB044CF0272664CD9200000000000000000" +
                "000000000000000434CC993C4C984636ECCD91600000000000000000000000000000000DD1D99BB848BD8423FFF311C00000000000000000000000000000000FDE7FEEF078C6000000000000000000000000000\r\n"
                + "PRINT\r\n";


        // transaction details that print in receipt
        String accNo  = "      Account No         : "+transaction.getClientAccountNo()+"\r\n";
        String name   = "      Name               : "+transaction.getClientName()+"\r\n";
        String mobNo  = "      Mobile No          : "+transaction.getClientMobile()+"\r\n";
        String time   = "      Transaction time   : "+transaction.getTransactionTime()+"\r\n";
        String amount = "      Transaction amount : "+transaction.getTransactionAmount()+"\r\n\r\n\r\n";

        String sign   = "..................          ..................\r\n";
        String end    = "    Customer                       Agent      \r\n\r\n\r\n";

        // send dat to printer
        // send data as byte stream
        try {
            // print customer copy
            outputStream.write(printLogoCommand.getBytes());
            outputStream.write(address.getBytes());
            outputStream.write(branch.getBytes());
            outputStream.write(telephoneNo.getBytes());
            outputStream.write(receiptType.getBytes());
            outputStream.write(accNo.getBytes());
            outputStream.write(name.getBytes());
            outputStream.write(mobNo.getBytes());
            outputStream.write(time.getBytes());
            outputStream.write(amount.getBytes());
            outputStream.write(sign.getBytes());
            outputStream.write(end.getBytes());

            //empty for loop for accurate use
            for(int i=0;i<10000;i++){

            }
            Thread.sleep(2000);

            outputStream.flush();
        } catch(Exception e) {
            throw new CannotPrintException();
        } finally {
            // close streams
            try {
                outputStream.close();
            } catch(Exception e) {
                throw new CannotPrintException();
            }
        }
    }

    /**
     * Print summary
     * @param summary summary object
     * @param settings
     * @throws BluetoothNotEnableException
     * @throws IOException
     * @throws CannotConnectToPrinterException
     * @throws BluetoothNotAvailableException
     * @throws CannotPrintException
     */
    public static void printSummary(Summary summary, Setting settings) throws BluetoothNotEnableException, IOException, CannotConnectToPrinterException, BluetoothNotAvailableException, CannotPrintException, IllegalArgumentException {
        OutputStream outputStream = connectToPrinter(settings.getPrinterAddress());

        // receipt header
        String address      = ".           SANASA Development Bank\r\n";
        String branch       = "            Branch       : " + settings.getBranch() + "\r\n";
        String telephoneNo  = "            Telephone No : " + settings.getTelephone()  + "\r\n";

        // printing receipt type
        // customer copy/ agent copy
        String receiptType  = "                (Day end summary)      \r\n\r\n";

        // logo printing command
        // ZPL(Zebra Program Language)
        String printLogoCommand = "! 0 200 200 150 1\r\n"  //"! 0 200 200 150 1\r\n"
                + "EG 28 126 200 10 " // EG 8LineWidth(16hex for 8 word) 128NoLine 100x 60y
                + "000000000000000000000000003E00000000000000000000000000000000000000000000000000003FFF0000000000000000000000000000000000000000000000000007FFFF000000000000000000000000000000000000000000000000003" +
                "FFFFE00000000000000000000000000000000000000000000000001FFFC0000000000000000000000000000000000000000000000000007FF00000000000000000000000000000000000000000000000000001FF801FFFF0000000000000000000000" +
                "0000000000000000000000007FC03FFFFFFC00000000000000000000000000000000000000000001FE01FFFFFFFF80000000000000000000000000000000000000000003FC0FFFE003FFF8000000000000000000000000000000000000000007F07FF" +
                "800001FFE00000000000000000000000000000000000000001FC0FFC0000001FFC0000000000000000000000000000000000000003F83FE03FFFFC03FF0000000000000000000000000000000000000007E0FF83FFFFFFC07FC000000000000000000" +
                "00000000000000000000FC1FE0FFFFFFFF81FE00000000000000000000000000000000000001F83F83FFE00FFFF07F80000000000000000000000000000000000003F0FE0FFC00003FFC1FC0000000000000000000000000000000000003E1FC3FE00" +
                "1E007FF07E0000000000000000000000000000000000007C3F87F007FFF80FFC3F800000000000000000000000000000000000FC3F0FE03FFFFF81FE0FC00000000000000000000000000000000000F87E3F80FFFFFFF07F87E000000000000000000" +
                "00000000000000001F0FC7F03FFFFFFFC3FC3F00000000000000000000000000000000001F1F8FE0FFFFC03FF0FE1F00000000000000000000000000000000003E1F0F81FFFF0007FC7F0F80000000000000000000000000000000003E3F1F83FFFF0" +
                "001FE3F87C0000000000000000000000000000000003E3E3F07FFFF00007F1FC7E0000000000000000000000000000000007C7C3E0FFFFF00003F8FE3E0000000000000000000000000000000007C7C7C0FFFFF00001FC7E1F0000000000000000000" +
                "000000000000007C7C7C0FFFFF800007E7F1F0000000000000000000000000000000007CF8F80FFFFFC00003F3F0F80000000000000000000000000000000078F8F80FFFFFF00001F1F8F800000000000000000000000000000000F8F8F80FFFFFFC0" +
                "001F9F87C00000000000000000000000000000000F8F8F80FFFFFFF0000F8FC7C00000000000000000000000000000000F8F8F80FFFFFFFC000FCFC7C00000000000000000000000000000000F8F8F007FFFFFFE0007CFC7C00000000000000000000" +
                "000000000000F8F8F803FFFFFFF8007C7C3E00000000000000000000000000000000F8F8F801FFFFFFFC007C7E3E00000000000000000000000000000000F8F8F800FFFFFFFE007C7E3E0000000000000000000000000000000078F8F8007FFFFFFF0" +
                "07C7E3E0000000000000000000000000000000078FCF8001FFFFFFF007E7E3E00000000000000000000000000000000787CFC000FFFFFFF807C7E3E000000000000000000000000000000007C7C7C0003FFFFFF807C7E3E0000000000000000000000" +
                "00000000007C7E7E0000FFFFFF807C7E3E000000000000000000000000000000003C3E3F00007FFFFF807C7E7E000000000000000000000000000000003E3F3F80001FFFFF807C7C7E000000000000000000000000000000003E1F1FC0000FFFFF80F" +
                "8FC7C000000000000000000000000000000001F0F8FE00007FFFF80F8FC7C000000000000000000000000000000001F0FC7F00003FFFF81F0FC7C000000000000000000000000000000000F87E3FC0003FFFF03F1F8FC000000000000000000000000" +
                "0000000007C3F1FF0003FFFF03E1F8F80000000000000000000000000000000007C1F87FC007FFFE07C3F1F80000000000000000000000000000000003E0FE3FF00FFFFC0FC7E1F80000000000000000000000000000000001F07F0FFFFFFFF81F8FE" +
                "3F00000000000000000000000000000000000F83F83FFFFFFE03F0FC3F000000000000000000000000000000000007C0FE0FFFFFF80FE1F87E000000000000000000000000000000000003F07F81FFFFE03F87F0FC000000000000000000000000000" +
                "000000001F81FE01FFE00FF0FE1FC0000000000000000000000000000000000007E0FFC000003FE1FC3F80000000000000000000000000000000000003F83FF80001FF87F87F00000000000000000000000000000000000000FC0FFFFF7FFE1FF0FE0" +
                "00000000000000000000000000000000000007F81FFFFFFF87FC1FC000000000000000000000000000000000000001FE03FFFFFC1FF83F80000000000000000000000000000000000000007FC00FFF80FFE0FE0000000000000000000000000000000" +
                "0000000001FFC000007FF83FC000000000000000000000000000000000000000003FFF803FFFE07F80000000000000000000000000000000000000000007FFFFFFFF01FE00000000000000000000000000000000000000000000FFFFFFF807F800000" +
                "0000000000000000000000000000000000000000FFFFF803FE000000000000000000000000000000000000000000000003FE001FF80000000000000000000000000000000000000000000000000000FFE000000000000000000000000000000000000" +
                "0000000000000003FFF000000000000000000000000000000000000000000000000001FFFF8000000000000000000000000000000000000000000000000001FFFC0000000000000000000000000000000000000000000000000001FFC000000000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007FC01FFFC007FFF80000000000000000000000000000000000000001FFF83FFFF807FFFF0000000000000000000" +
                "000000000000000000007FFFC3FFFFE07FFFFC00000000000000000000000000000000000000FFFFF3FFFFF07FFFFE00000000000000000000000000000000000001FFFFF07FFFF81FFFFF00000000000000000000000000000000000001FC03F07E0" +
                "3FC0F80FF03F0000000000001F800000000000000000001F801F07E01FC0F803F03F0000000000001F800000000000000000003F801F07E00FE0F803F80F00000000000007800000000000000000003F801F07E007E0F803F80700000000000007800" +
                "000000000000000001F800F07E007E0F803F00700000000000007800000000000000000001FC00007E007F0F803F00700000000000007800000000000000000001FF00007E003F0F807F00700000000000007800000000000000000000FFE0007E003" +
                "F0FFFFE0073F003F01F1F0078FE0000000000000000007FFC007E003F0FFFFC0077F80FFC3F7F8078FF0000000000000000003FFF007E003F0FFFFC007FFC1FFE1FFFC078FF0000000000000000000FFF807E003F0FFFFE007C3E1C1F07C3E0787800" +
                "000000000000000001FFE07E003F0FFFFF00781E1C0F0781E078F0000000000000000000003FE07E003F0F803F80700E18070700E079F0000000000000000000000FF07E003F0F801F80700E00070780E079E0000000000000000001E003F07E007F0" +
                "F801F80700F000F0780E07FC0000000000000000003E003F07E007E0F801FC0700F07FF0780E07F80000000000000000003F003F07E00FE0F801FC0700F1FFF0780E07FC0000000000000000003F003F07E00FE0F801F80700F1E070780E079E00000" +
                "00000000000003F003F07E01FC0F801F80700F3C070780E078F0000000000000000003FC0FF07E0FF80F80FF80700E3C070780E078F0000000000000000001FFFFE1FFFFF87FFFFF00781E3C0F0780E07878000000000000000000FFFFC3FFFFF07FF" +
                "FFE007C3E3C3F0700E0783C0000000000000000007FFF83FFFFC07FFFFC007FFC1FFF9FE7F9FE7F0000000000000000001FFF03FFFF007FFFF00077F80FF7BFE7FDFE7F80000000000000000003F8000000000000000023E007C79FC3F9FC3F000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000080006000310040000000000000000000000000000000000000400000800C40007300C0000000000000000000" +
                "000000000000000000C00001800CC0007201C8000000000000000000000000000000000000C00003003D8000E623C880C000000000000000000000000000000001800C0B3039E380E4F913C7C0000000000000000000000000000000030F1F3E2033E" +
                "6C1ED9B33EEC0000000000000000000000000000000030D366660236C813B32267D80000000000000000000000000000000021B66CCE066CF837B36645980000000000000000000000000000000061E64CDB044CF0272664CD9200000000000000000" +
                "000000000000000434CC993C4C984636ECCD91600000000000000000000000000000000DD1D99BB848BD8423FFF311C00000000000000000000000000000000FDE7FEEF078C6000000000000000000000000000\r\n"
                + "PRINT\r\n";

        // transaction details that print in receipt
        //String branch = "      Branch Id          : "+summary.getBranchId()+"\r\n";
        String depositCount  = "      Deposit count      : "+Integer.toString(summary.getCount())+"\r\n";
        String depositAmount = "      Deposit amount     : "+TransactionUtils.formatAmount(summary.getTotal()) +"\r\n";
        String date          = "      Date               : "+summary.getTime()+"\r\n\r\n\r\n";

        String sign          = "             ....................             \r\n";
        String end           = "                    Agent             \r\n\r\n\r\n";

        // send dat to printer
        // send data as byte stream
        try {
            // print customer copy
            outputStream.write(printLogoCommand.getBytes());
            outputStream.write(address.getBytes());
            outputStream.write(branch.getBytes());
            outputStream.write(telephoneNo.getBytes());
            outputStream.write(receiptType.getBytes());
            outputStream.write(depositCount.getBytes());
            outputStream.write(depositAmount.getBytes());
            outputStream.write(date.getBytes());
            outputStream.write(sign.getBytes());
            outputStream.write(end.getBytes());

            //empty for loop for accurate use
            for(int i=0;i<10000;i++){

            }
            Thread.sleep(2000);

            outputStream.flush();
        } catch(Exception e) {
            throw new CannotPrintException();
        } finally {
            // close streams
            try {
                outputStream.close();
            } catch(Exception e) {
                throw new CannotPrintException();
            }
        }
    }

    /**
     * Print test print
     * @param settings
     * @throws BluetoothNotEnableException
     * @throws IOException
     * @throws CannotConnectToPrinterException
     * @throws BluetoothNotAvailableException
     * @throws CannotPrintException
     */
    public static void printTestPrint(Setting settings) throws BluetoothNotEnableException, IOException, CannotConnectToPrinterException, BluetoothNotAvailableException, CannotPrintException, IllegalArgumentException {
        OutputStream outputStream = connectToPrinter(settings.getPrinterAddress());

        // receipt header
        String address      = ".            SANASA Development Bank\r\n";
        String branch       = "             Branch       : " + settings.getBranch() + "\r\n";
        String telephoneNo  = "             Telephone No : " + settings.getTelephone()  + "\r\n";

        // printing receipt type
        // customer copy/ agent copy
        String receiptType  = "                    (Test copy)      \r\n\r\n";

        // logo printing command
        // ZPL(Zebra Program Language)
        String printLogoCommand = "! 0 200 200 150 1\r\n"  //"! 0 200 200 150 1\r\n"
                + "EG 28 126 200 10 " // EG 8LineWidth(16hex for 8 word) 128NoLine 100x 60y
                + "000000000000000000000000003E00000000000000000000000000000000000000000000000000003FFF0000000000000000000000000000000000000000000000000007FFFF000000000000000000000000000000000000000000000000003" +
                "FFFFE00000000000000000000000000000000000000000000000001FFFC0000000000000000000000000000000000000000000000000007FF00000000000000000000000000000000000000000000000000001FF801FFFF0000000000000000000000" +
                "0000000000000000000000007FC03FFFFFFC00000000000000000000000000000000000000000001FE01FFFFFFFF80000000000000000000000000000000000000000003FC0FFFE003FFF8000000000000000000000000000000000000000007F07FF" +
                "800001FFE00000000000000000000000000000000000000001FC0FFC0000001FFC0000000000000000000000000000000000000003F83FE03FFFFC03FF0000000000000000000000000000000000000007E0FF83FFFFFFC07FC000000000000000000" +
                "00000000000000000000FC1FE0FFFFFFFF81FE00000000000000000000000000000000000001F83F83FFE00FFFF07F80000000000000000000000000000000000003F0FE0FFC00003FFC1FC0000000000000000000000000000000000003E1FC3FE00" +
                "1E007FF07E0000000000000000000000000000000000007C3F87F007FFF80FFC3F800000000000000000000000000000000000FC3F0FE03FFFFF81FE0FC00000000000000000000000000000000000F87E3F80FFFFFFF07F87E000000000000000000" +
                "00000000000000001F0FC7F03FFFFFFFC3FC3F00000000000000000000000000000000001F1F8FE0FFFFC03FF0FE1F00000000000000000000000000000000003E1F0F81FFFF0007FC7F0F80000000000000000000000000000000003E3F1F83FFFF0" +
                "001FE3F87C0000000000000000000000000000000003E3E3F07FFFF00007F1FC7E0000000000000000000000000000000007C7C3E0FFFFF00003F8FE3E0000000000000000000000000000000007C7C7C0FFFFF00001FC7E1F0000000000000000000" +
                "000000000000007C7C7C0FFFFF800007E7F1F0000000000000000000000000000000007CF8F80FFFFFC00003F3F0F80000000000000000000000000000000078F8F80FFFFFF00001F1F8F800000000000000000000000000000000F8F8F80FFFFFFC0" +
                "001F9F87C00000000000000000000000000000000F8F8F80FFFFFFF0000F8FC7C00000000000000000000000000000000F8F8F80FFFFFFFC000FCFC7C00000000000000000000000000000000F8F8F007FFFFFFE0007CFC7C00000000000000000000" +
                "000000000000F8F8F803FFFFFFF8007C7C3E00000000000000000000000000000000F8F8F801FFFFFFFC007C7E3E00000000000000000000000000000000F8F8F800FFFFFFFE007C7E3E0000000000000000000000000000000078F8F8007FFFFFFF0" +
                "07C7E3E0000000000000000000000000000000078FCF8001FFFFFFF007E7E3E00000000000000000000000000000000787CFC000FFFFFFF807C7E3E000000000000000000000000000000007C7C7C0003FFFFFF807C7E3E0000000000000000000000" +
                "00000000007C7E7E0000FFFFFF807C7E3E000000000000000000000000000000003C3E3F00007FFFFF807C7E7E000000000000000000000000000000003E3F3F80001FFFFF807C7C7E000000000000000000000000000000003E1F1FC0000FFFFF80F" +
                "8FC7C000000000000000000000000000000001F0F8FE00007FFFF80F8FC7C000000000000000000000000000000001F0FC7F00003FFFF81F0FC7C000000000000000000000000000000000F87E3FC0003FFFF03F1F8FC000000000000000000000000" +
                "0000000007C3F1FF0003FFFF03E1F8F80000000000000000000000000000000007C1F87FC007FFFE07C3F1F80000000000000000000000000000000003E0FE3FF00FFFFC0FC7E1F80000000000000000000000000000000001F07F0FFFFFFFF81F8FE" +
                "3F00000000000000000000000000000000000F83F83FFFFFFE03F0FC3F000000000000000000000000000000000007C0FE0FFFFFF80FE1F87E000000000000000000000000000000000003F07F81FFFFE03F87F0FC000000000000000000000000000" +
                "000000001F81FE01FFE00FF0FE1FC0000000000000000000000000000000000007E0FFC000003FE1FC3F80000000000000000000000000000000000003F83FF80001FF87F87F00000000000000000000000000000000000000FC0FFFFF7FFE1FF0FE0" +
                "00000000000000000000000000000000000007F81FFFFFFF87FC1FC000000000000000000000000000000000000001FE03FFFFFC1FF83F80000000000000000000000000000000000000007FC00FFF80FFE0FE0000000000000000000000000000000" +
                "0000000001FFC000007FF83FC000000000000000000000000000000000000000003FFF803FFFE07F80000000000000000000000000000000000000000007FFFFFFFF01FE00000000000000000000000000000000000000000000FFFFFFF807F800000" +
                "0000000000000000000000000000000000000000FFFFF803FE000000000000000000000000000000000000000000000003FE001FF80000000000000000000000000000000000000000000000000000FFE000000000000000000000000000000000000" +
                "0000000000000003FFF000000000000000000000000000000000000000000000000001FFFF8000000000000000000000000000000000000000000000000001FFFC0000000000000000000000000000000000000000000000000001FFC000000000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007FC01FFFC007FFF80000000000000000000000000000000000000001FFF83FFFF807FFFF0000000000000000000" +
                "000000000000000000007FFFC3FFFFE07FFFFC00000000000000000000000000000000000000FFFFF3FFFFF07FFFFE00000000000000000000000000000000000001FFFFF07FFFF81FFFFF00000000000000000000000000000000000001FC03F07E0" +
                "3FC0F80FF03F0000000000001F800000000000000000001F801F07E01FC0F803F03F0000000000001F800000000000000000003F801F07E00FE0F803F80F00000000000007800000000000000000003F801F07E007E0F803F80700000000000007800" +
                "000000000000000001F800F07E007E0F803F00700000000000007800000000000000000001FC00007E007F0F803F00700000000000007800000000000000000001FF00007E003F0F807F00700000000000007800000000000000000000FFE0007E003" +
                "F0FFFFE0073F003F01F1F0078FE0000000000000000007FFC007E003F0FFFFC0077F80FFC3F7F8078FF0000000000000000003FFF007E003F0FFFFC007FFC1FFE1FFFC078FF0000000000000000000FFF807E003F0FFFFE007C3E1C1F07C3E0787800" +
                "000000000000000001FFE07E003F0FFFFF00781E1C0F0781E078F0000000000000000000003FE07E003F0F803F80700E18070700E079F0000000000000000000000FF07E003F0F801F80700E00070780E079E0000000000000000001E003F07E007F0" +
                "F801F80700F000F0780E07FC0000000000000000003E003F07E007E0F801FC0700F07FF0780E07F80000000000000000003F003F07E00FE0F801FC0700F1FFF0780E07FC0000000000000000003F003F07E00FE0F801F80700F1E070780E079E00000" +
                "00000000000003F003F07E01FC0F801F80700F3C070780E078F0000000000000000003FC0FF07E0FF80F80FF80700E3C070780E078F0000000000000000001FFFFE1FFFFF87FFFFF00781E3C0F0780E07878000000000000000000FFFFC3FFFFF07FF" +
                "FFE007C3E3C3F0700E0783C0000000000000000007FFF83FFFFC07FFFFC007FFC1FFF9FE7F9FE7F0000000000000000001FFF03FFFF007FFFF00077F80FF7BFE7FDFE7F80000000000000000003F8000000000000000023E007C79FC3F9FC3F000000" +
                "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
                "000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000080006000310040000000000000000000000000000000000000400000800C40007300C0000000000000000000" +
                "000000000000000000C00001800CC0007201C8000000000000000000000000000000000000C00003003D8000E623C880C000000000000000000000000000000001800C0B3039E380E4F913C7C0000000000000000000000000000000030F1F3E2033E" +
                "6C1ED9B33EEC0000000000000000000000000000000030D366660236C813B32267D80000000000000000000000000000000021B66CCE066CF837B36645980000000000000000000000000000000061E64CDB044CF0272664CD9200000000000000000" +
                "000000000000000434CC993C4C984636ECCD91600000000000000000000000000000000DD1D99BB848BD8423FFF311C00000000000000000000000000000000FDE7FEEF078C6000000000000000000000000000\r\n"
                + "PRINT\r\n";

        // transaction details that print in receipt
        String accNo  = "      Account No         : "+"Test account"+"\r\n";
        String name   = "      Name               : "+"Test name"+"\r\n";
        String mobNo  = "      Mobile No          : "+"Test mobile"+"\r\n";
        String time   = "      Transaction time   : "+"Test time"+"\r\n";
        String amount = "      Transaction amount : "+"Test amount"+"\r\n";
        String balance= "      Balance            : "+"Test balance"+"\r\n";
        String recNo  = "      Receipt No         : "+"Test receipt"+"\r\n\r\n\r\n";

        String sign   = "  ..................        ..................\r\n";
        String end    = "      Customer                     Agent      \r\n\r\n\r\n";

        // send dat to printer
        // send data as byte stream
        try {
            // print customer copy
            outputStream.write(printLogoCommand.getBytes());
            outputStream.write(address.getBytes());
            outputStream.write(branch.getBytes());
            outputStream.write(telephoneNo.getBytes());
            outputStream.write(receiptType.getBytes());
            outputStream.write(accNo.getBytes());
            outputStream.write(name.getBytes());
            outputStream.write(mobNo.getBytes());
            outputStream.write(time.getBytes());
            outputStream.write(amount.getBytes());
            outputStream.write(balance.getBytes());
            outputStream.write(recNo.getBytes());
            outputStream.write(sign.getBytes());
            outputStream.write(end.getBytes());

            //empty for loop for accurate use
            for(int i=0;i<10000;i++){

            }
            Thread.sleep(2000);

            outputStream.flush();
        } catch(Exception e) {
            throw new CannotPrintException();
        } finally {
            // close streams
            try {
                outputStream.close();
            } catch(Exception e) {
                throw new CannotPrintException();
            }
        }
    }
}